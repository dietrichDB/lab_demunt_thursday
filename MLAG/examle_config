BASE ASSUMPTIONS

MLAG on Leaf switches (LEAF1 & LEAF 2)

Element Value
MLAG Domain10
Peer links Ethernet 3 & 4
Client links: Ethernet 5
peer-link Port-Channel100
MLAG VLAN 4094

Links to non-MLAG Peers: 
- Ethernet 1 SW 1 and 1 SW 2 (Port-Channel 1, MLAG 1)
- Ethernet 2 SW1 and 2 SW 2 (Port-Channel 2, MLAG 2)

SPINE LinksEthernet5 & Ethernet6
VLAN ID10
VLAN NameServer_VLAN
SVI IP10.0.10.1/24 (VARP)
Host IPsStatic or via DHCP

3. LAB CONFIGS

*** SPINE1 & SPINE2 ***


hostname SPINE1
interface Ethernet1
channel-group 1 mode active
!
interface Ethernet2
channel-group 1 mode active
!
ip routing
!
interface port-channel 1
switchport mode trunk

(Repeat similarly on SPINE2 with IPs 192.168.1.3/31 and 192.168.1.7/31)

*** LEAF1 CONFIG ***

hostname LEAF1
interface Management1
ip address 10.0.0.1/24
!
interface Ethernet1
channel-group 1 mode active
!
interface Ethernet2
channel-group 2 mode active
!
interface Port-Channel100
switchport
switchport mode trunk
switchport trunk group mlagpeer
!
interface Port-Channel1
switchport
switchport access vlan 10
mlag 1
!
interface Port-Channel2
switchport
switchport access vlan 10
mlag 2
!
vlan 10
name Server_VLAN
!
interface Vlan1
ip address 10.0.10.1/24
!
mlag configuration
domain-id 10
local-interface Vlan4094
peer-address 10.0.0.2
peer-link Port-Channel100
!
int vlan 4094
ip address 10.0.0.1/24
no autostate

*** LEAF2 CONFIG ***

hostname LEAF2
!
interface Management1
ip address 10.0.0.2/24
!
interface Ethernet1
channel-group 1 mode active
!
interface Ethernet2
channel-group 2 mode active
!
interface Port-Channel100
switchport
switchport mode trunk
switchport trunk group mlagpeer
!
interface Port-Channel1
switchport
switchport access vlan 10
mlag 1
!
interface Port-Channel2
switchport
switchport access vlan 10
mlag 2
!
interface Port-Channel100
switchport
switchport mode trunk
switchport trunk group mlagpeer
!
vlan 10
name Server_VLAN
!
interface Vlan10
ip address  10.0.10.2/24
!
mlag configuration
domain-id 10
local-interface Vlan4094
peer-address 10.0.0.1
peer-link Port-Channel100
!
int vlan 4094
ip address 10.0.0.2/24
no autostate

